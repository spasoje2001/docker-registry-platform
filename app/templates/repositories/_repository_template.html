<div class="card-body p-4">
    <form method="post"
          action="{% if repository %}
              {% if repository.is_official %}
                  {% url 'repositories:update_official' repository.name %}{% if request.GET.from_profile %}?from_profile=1{% endif %}
              {% else %}
                  {% url 'repositories:update' repository.owner.username repository.name %}{% if request.GET.from_profile %}?from_profile=1{% endif %}
              {% endif %}
          {% else %}
              {% url 'repositories:create' %}
          {% endif %}">
        {% csrf_token %}

        {% if request.resolver_match.url_name == "profile" or request.GET.from_profile %}
            <input type="hidden" name="from_profile" value="1">
        {% endif %}

        <div class="mb-4">
            <label for="{{ form.name.id_for_label }}" class="form-label fw-semibold">
                Name <span class="text-danger">*</span>
            </label>
            <div class="input-group">
                <span class="input-group-text">
                    <i class="bi bi-tag"></i>
                </span>
                {{ form.name }}
            </div>
            {% if form.name.errors %}
                <div class="text-danger mt-2">
                    {{ form.name.errors.0 }}
                </div>
            {% else %}
                <i class="bi bi-info-circle"></i>
                Lowercase alphanumeric with hyphens (e.g., my-awesome-repo)
            {% endif %}
        </div>

        <div class="mb-4">
            <label for="{{ form.description.id_for_label }}" class="form-label fw-semibold">
                Description
            </label>
            {{ form.description }}
            {% if form.description.errors %}
                <div class="text-danger mt-2">
                    {{ form.description.errors.0 }}
                </div>
            {% endif %}
            <div class="form-text">
                <i class="bi bi-chat-left-text"></i>
                A brief description of what this repository is about
            </div>
        </div>

        <div class="mb-4">
            <label for="{{ form.visibility.id_for_label }}" class="form-label fw-semibold">
                Visibility <span class="text-danger">*</span>
            </label>
            {{ form.visibility }}
            {% if form.visibility.errors %}
                <div class="text-danger mt-2">
                    {{ form.visibility.errors.0 }}
                </div>
            {% endif %}
            <div class="form-text">
                <i class="bi bi-eye"></i>
                <strong>Public:</strong> Anyone can see this repository â€¢
                <i class="bi bi-lock"></i>
                <strong>Private:</strong> Only you can see this repository
            </div>
        </div>

        {% if user.is_admin %}
            <div class="mb-4">
                <div class="form-check">
                    <input type="checkbox"
                           class="form-check-input"
                           id="{{ form.is_official.id_for_label }}"
                           name="{{ form.is_official.html_name }}"
                           {% if form.is_official.value %}checked{% endif %}
                           {% if repository.is_official %}disabled{% endif %}>
                    <label class="form-check-label fw-semibold" for="{{ form.is_official.id_for_label }}">
                        Official Repository
                    </label>
                </div>

                {% if form.is_official.errors %}
                    <div class="text-danger mt-2">
                        <i class="bi bi-exclamation-circle"></i>
                        {{ form.is_official.errors.0 }}
                    </div>
                {% endif %}

                {% if form.non_field_errors %}
                    <div class="text-danger mt-2">
                        <i class="bi bi-exclamation-circle"></i>
                        {{ form.non_field_errors.0 }}
                    </div>
                {% endif %}

                <div class="form-text">
                    <i class="bi bi-info-circle"></i>
                    {% if repository.is_official %}
                        <strong>Note:</strong> Official repositories cannot be converted back to personal repositories.
                    {% else %}
                        Official repositories are publicly available system-level images (e.g., python, nginx). They must be public.
                    {% endif %}
                </div>
            </div>
        {% endif %}


        <div class="d-flex gap-2 pt-3 border-top">
            <button type="submit" class="btn btn-success">
                <i class="bi bi-{% if repository %}check-circle{% else %}plus-circle{% endif %}"></i>
                {% if repository %}Update{% else %}Create{% endif %}
            </button>
            <button type="reset" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-counterclockwise"></i> Reset
            </button>
        </div>
    </form>
</div>

<div class="alert alert-info mt-4" role="alert">
    <i class="bi bi-lightbulb"></i>
    <strong>Tip:</strong> Choose a descriptive name for your repository. You won't be able to change it later!
</div>